# ViralBERT v2 üöÄ

Multi-task –º–æ–¥–µ–ª—å –Ω–∞ –±–∞–∑–µ RuBERT-base –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Ä—É—Å—Å–∫–æ—è–∑—ã—á–Ω—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üéØ **–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç–∏** ‚Äî –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞ –Ω–∞ –≤–∏—Ä—É—Å–Ω—ã–π/—Å–∫—É—á–Ω—ã–π
- üòä **–†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —ç–º–æ—Ü–∏–π** ‚Äî 28 —Ç–∏–ø–æ–≤ —ç–º–æ—Ü–∏–π (—Ä–∞–¥–æ—Å—Ç—å, –≥—Ä—É—Å—Ç—å, –≥–Ω–µ–≤, —É–¥–∏–≤–ª–µ–Ω–∏–µ –∏ –¥—Ä.)
- üîç **–ê–Ω–∞–ª–∏–∑ –ø–æ –æ–∫–Ω–∞–º** ‚Äî –ø–æ–∏—Å–∫ —Å–∞–º—ã—Ö —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã—Ö –º–æ–º–µ–Ω—Ç–æ–≤ –≤ –¥–ª–∏–Ω–Ω—ã—Ö —Ç–µ–∫—Å—Ç–∞—Ö
- üá∑üá∫ **–†—É—Å—Å–∫–∏–π —è–∑—ã–∫** ‚Äî –æ–±—É—á–µ–Ω–∞ –Ω–∞ ru_go_emotions –¥–∞—Ç–∞—Å–µ—Ç–µ

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞

git clone https://github.com/<username>/viralbert.git
cd viralbert
pip install -r requirements.txt

### 2. –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–µ–π –∏ –¥–∞–Ω–Ω—ã—Ö

python v2/download_rubert.py
python v2/download_emo.py

### 3. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –≤–∞—à–µ–≥–æ –¥–∞—Ç–∞—Å–µ—Ç–∞

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `final_train_dataset.csv` —Å –∫–æ–ª–æ–Ω–∫–∞–º–∏:
- `text` ‚Äî —Ç–µ–∫—Å—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
- `label` ‚Äî 0 (—Å–∫—É—á–Ω—ã–π) –∏–ª–∏ 1 (–≤–∏—Ä—É—Å–Ω—ã–π)

–ü—Ä–∏–º–µ—Ä:

text,label
"–û–±—ã—á–Ω–∞—è –Ω–æ–≤–æ—Å—Ç—å –æ –ø–æ–≥–æ–¥–µ",0
"–®–æ–∫–∏—Ä—É—é—â–µ–µ –æ—Ç–∫—Ä—ã—Ç–∏–µ —É—á–µ–Ω—ã—Ö!",1

### 4. –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –¥–∞—Ç–∞—Å–µ—Ç–æ–≤

python v2/prepare_dataset.py

### 5. –û–±—É—á–µ–Ω–∏–µ

python v2/train.py

‚è±Ô∏è –í—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è:
- GPU (T4/A2): 20-40 –º–∏–Ω—É—Ç
- CPU: 3-6 —á–∞—Å–æ–≤

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

- **Encoder**: RuBERT-base (768-dim, ~180M –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤)
- **Head 1**: –ü–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç—å (–±–∏–Ω–∞—Ä–Ω–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è)
- **Head 2**: –≠–º–æ—Ü–∏–∏ (multi-label, 28 –∫–ª–∞—Å—Å–æ–≤)
- **–û–±—É—á–µ–Ω–∏–µ**: Multi-task learning —Å –∑–∞–º–æ—Ä–æ–∑–∫–æ–π BERT –Ω–∞ –ø–µ—Ä–≤—ã—Ö —ç–ø–æ—Ö–∞—Ö

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

viralbert/
‚îú‚îÄ‚îÄ v2/
‚îÇ   ‚îú‚îÄ‚îÄ model.py              # MultiTaskClassifier
‚îÇ   ‚îú‚îÄ‚îÄ train.py              # –°–∫—Ä–∏–ø—Ç –æ–±—É—á–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ prepare_dataset.py    # –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îú‚îÄ‚îÄ download_rubert.py    # –ó–∞–≥—Ä—É–∑–∫–∞ RuBERT
‚îÇ   ‚îî‚îÄ‚îÄ download_emo.py       # –ó–∞–≥—Ä—É–∑–∫–∞ ru_go_emotions
‚îú‚îÄ‚îÄ models/                   # –°–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –≤–µ—Å–∞
‚îî‚îÄ‚îÄ requirements.txt

## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

–ü–æ—Å–ª–µ –æ–±—É—á–µ–Ω–∏—è –≤–µ—Å–∞ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `models/`:
- `multitask_best.pth` ‚Äî –ª—É—á—à–∞—è –º–æ–¥–µ–ª—å –ø–æ validation loss
- `multitask_final.pth` ‚Äî —Ñ–∏–Ω–∞–ª—å–Ω–∞—è —ç–ø–æ—Ö–∞

## –î–∞—Ç–∞—Å–µ—Ç—ã

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç [ru_go_emotions](https://huggingface.co/datasets/seara/ru_go_emotions) ‚Äî —Ä—É—Å—Å–∫–∏–π –ø–µ—Ä–µ–≤–æ–¥ GoEmotions –æ—Ç Google.

28 —ç–º–æ—Ü–∏–π –≤–∫–ª—é—á–∞—é—Ç: —Ä–∞–¥–æ—Å—Ç—å, –≥—Ä—É—Å—Ç—å, –∑–ª–æ—Å—Ç—å, —Å—Ç—Ä–∞—Ö, —É–¥–∏–≤–ª–µ–Ω–∏–µ, –≤–æ—Å—Ö–∏—â–µ–Ω–∏–µ, –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç—å –∏ –¥—Ä.

## –î–µ–ø–ª–æ–π –Ω–∞ –æ–±–ª–∞—á–Ω—ã–π —Å–µ—Ä–≤–µ—Ä

–î–ª—è –æ–±—É—á–µ–Ω–∏—è –Ω–∞ Selectel/–¥—Ä—É–≥–æ–º –æ–±–ª–∞–∫–µ:

bash v2/setup_server.sh

–ó–∞—Ç–µ–º —Å–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –≤—ã—à–µ.

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.11+
- PyTorch 2.0+
- Transformers 4.36+
- CUDA 11.8+ (–¥–ª—è GPU)

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT

## –ê–≤—Ç–æ—Ä—ã

–ü—Ä–æ–µ–∫—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω –¥–ª—è –ø–æ–∏—Å–∫–∞ –≤–∏—Ä–∞–ª—å–Ω—ã—Ö –º–æ–º–µ–Ω—Ç–æ–≤ –≤ —Ç–µ–∫—Å—Ç–∞—Ö.
